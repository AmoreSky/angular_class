<div class="dashboard-layout">
    <app-artisan-side-bar></app-artisan-side-bar>

    <div class="main-content">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" (click)="toggleMenu()">
            <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                    d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z" />
            </svg>
        </button>

        <div class="topbar">
            <h2>Welcome, {{user}}!</h2>
            <input class="form-control search" placeholder="Search...">
            <button class="btn btn-success" (click)="logout()">Logout</button>
        </div>

        <div class="kpis">
            <div class="kpi card">
                <div class="label">My Rating</div>
                <div class="value">{{rating}}</div>
                <div class="muted">({{reviews}} reviews)</div>
            </div>
            <div class="kpi card">
                <div class="label">Total Earnings</div>
                <div class="value">${{earnings}}</div>
            </div>
            <div class="kpi card">
                <div class="label">Completed Jobs</div>
                <div class="value">{{completedJobs}}</div>
            </div>
        </div>

        <div class="row">
            <div class="col-left">
                <section class="card">
                    <h3>New Job Offers</h3>
                    @for (job of newJobs; track job.title) {
                    <div class="job">
                        <div>
                            <div class="title">{{job.title}}</div>
                            <div class="meta">Customer: {{job.customer}} • {{job.location}} • Budget ${{job.budget}}
                            </div>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-outline-primary" (click)="apply(job)">Apply</button>
                        </div>
                    </div>
                    }
                </section>

                <section class="card mt">
                    <h3>My Active Projects</h3>
                    @for (p of activeProjects; track p.title) {
                    <div class="job">
                        <div>
                            <div class="title">Client: {{p.client}} • {{p.title}}</div>
                            <div class="meta">Status: {{p.status}}</div>
                        </div>
                        <div class="actions">
                            @if (p.status === 'In Progress') {
                            <span class="badge">In Progress</span>
                            <button class="btn btn-sm btn-outline-primary" (click)="messageClient(p)">Message
                                Client</button>
                            }
                            @if (p.status === 'Payment Pending') {
                            <span class="badge pending">Payment Pending</span>
                            <button class="btn btn-sm btn-success" (click)="requestPayout(p)">Request
                                Payout</button>
                            }
                        </div>
                    </div>
                    }
                </section>
            </div>

            <aside class="col-right">
                <section class="card">
                    <h4>Profile Strength</h4>
                    <p class="muted">Complete your profile to get more jobs</p>
                    <div class="progress">
                        <div class="bar" style="width:65%"></div>
                    </div>
                    <button class="btn btn-primary mt-2">Complete Profile</button>
                </section>

                <section class="card mt">
                    <h4>Quick Links</h4>
                    <div class="links">
                        <button class="btn btn-outline-secondary">Payouts</button>
                        <button class="btn btn-outline-secondary">Messages</button>
                        <button class="btn btn-outline-secondary">Settings</button>
                    </div>
                </section>
            </aside>
        </div>
    </div>
</div>